<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Relations and Facts - Scallop Book</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="Use Scallop for Logic Programming and Neuro-symbolic Programming">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../introduction.html">Introduction</a></li><li class="chapter-item expanded affix "><li class="part-title">Getting Started</li><li class="chapter-item expanded "><a href="../installation.html"><strong aria-hidden="true">1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="../crash_course.html"><strong aria-hidden="true">2.</strong> Crash Course</a></li><li class="chapter-item expanded affix "><li class="part-title">Language Reference Guide</li><li class="chapter-item expanded "><a href="../language/index.html"><strong aria-hidden="true">3.</strong> Scallop and Logic Programming</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../language/relation.html" class="active"><strong aria-hidden="true">3.1.</strong> Relations and Facts</a></li><li class="chapter-item expanded "><a href="../language/rules.html"><strong aria-hidden="true">3.2.</strong> Writing Rules</a></li><li class="chapter-item expanded "><a href="../language/value_type.html"><strong aria-hidden="true">3.3.</strong> Values and Types</a></li><li class="chapter-item expanded "><a href="../language/query.html"><strong aria-hidden="true">3.4.</strong> Writing a Query</a></li><li class="chapter-item expanded "><a href="../language/recursion.html"><strong aria-hidden="true">3.5.</strong> Recursive Rules</a></li><li class="chapter-item expanded "><a href="../language/negation.html"><strong aria-hidden="true">3.6.</strong> Negations</a></li><li class="chapter-item expanded "><a href="../language/aggregation.html"><strong aria-hidden="true">3.7.</strong> Aggregations</a></li><li class="chapter-item expanded "><a href="../language/constants.html"><strong aria-hidden="true">3.8.</strong> Declaring Constants</a></li><li class="chapter-item expanded "><a href="../language/adt_and_entity.html"><strong aria-hidden="true">3.9.</strong> Algebraic Data Type and Entities</a></li><li class="chapter-item expanded "><a href="../language/magic_set.html"><strong aria-hidden="true">3.10.</strong> On-Demand Predicates</a></li><li class="chapter-item expanded "><a href="../language/loading_csv.html"><strong aria-hidden="true">3.11.</strong> Loading from CSV</a></li><li class="chapter-item expanded "><a href="../language/foreign_functions.html"><strong aria-hidden="true">3.12.</strong> Foreign Functions</a></li><li class="chapter-item expanded "><a href="../language/foreign_predicates.html"><strong aria-hidden="true">3.13.</strong> Foreign Predicates</a></li><li class="chapter-item expanded "><a href="../language/reference_guide.html"><strong aria-hidden="true">3.14.</strong> Reference Guide</a></li></ol></li><li class="chapter-item expanded "><a href="../probabilistic/index.html"><strong aria-hidden="true">4.</strong> Provenance and Probabilistic Programming</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../probabilistic/provenance.html"><strong aria-hidden="true">4.1.</strong> Provenance</a></li><li class="chapter-item expanded "><a href="../probabilistic/proofs.html"><strong aria-hidden="true">4.2.</strong> Proofs Provenance</a></li><li class="chapter-item expanded "><a href="../probabilistic/facts.html"><strong aria-hidden="true">4.3.</strong> Fact with Probability</a></li><li class="chapter-item expanded "><a href="../probabilistic/logic.html"><strong aria-hidden="true">4.4.</strong> Logic and Probability</a></li><li class="chapter-item expanded "><a href="../probabilistic/library.html"><strong aria-hidden="true">4.5.</strong> Provenance Library</a></li><li class="chapter-item expanded "><a href="../probabilistic/aggregation.html"><strong aria-hidden="true">4.6.</strong> Aggregation and Probability</a></li><li class="chapter-item expanded "><a href="../probabilistic/sampling.html"><strong aria-hidden="true">4.7.</strong> Sampling with Probability</a></li></ol></li><li class="chapter-item expanded "><a href="../scallopy/index.html"><strong aria-hidden="true">5.</strong> scallopy</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../scallopy/getting_started.html"><strong aria-hidden="true">5.1.</strong> Getting Started</a></li><li class="chapter-item expanded "><a href="../scallopy/context.html"><strong aria-hidden="true">5.2.</strong> Scallop Context</a></li><li class="chapter-item expanded "><a href="../scallopy/branching.html"><strong aria-hidden="true">5.3.</strong> Branching Executions</a></li><li class="chapter-item expanded "><a href="../scallopy/provenance.html"><strong aria-hidden="true">5.4.</strong> Configuring Provenance</a></li><li class="chapter-item expanded "><a href="../scallopy/module.html"><strong aria-hidden="true">5.5.</strong> Creating Module</a></li><li class="chapter-item expanded "><a href="../scallopy/module_input.html"><strong aria-hidden="true">5.6.</strong> Configuring Input Relations</a></li><li class="chapter-item expanded "><a href="../scallopy/module_output.html"><strong aria-hidden="true">5.7.</strong> Configuring Output Relations</a></li><li class="chapter-item expanded "><a href="../scallopy/foreign_function.html"><strong aria-hidden="true">5.8.</strong> Foreign Functions</a></li><li class="chapter-item expanded "><a href="../scallopy/foreign_predicate.html"><strong aria-hidden="true">5.9.</strong> Foreign Predicate</a></li><li class="chapter-item expanded "><a href="../scallopy/save_and_load.html"><strong aria-hidden="true">5.10.</strong> Saving and Loading</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Toolchain</li><li class="chapter-item expanded "><a href="../toolchain/cli.html"><strong aria-hidden="true">6.</strong> Scallop CLI</a></li><li class="chapter-item expanded "><a href="../toolchain/scli.html"><strong aria-hidden="true">7.</strong> Scallop Interpreter</a></li><li class="chapter-item expanded "><a href="../toolchain/sclrepl.html"><strong aria-hidden="true">8.</strong> Scallop REPL</a></li><li class="chapter-item expanded "><a href="../toolchain/sclc.html"><strong aria-hidden="true">9.</strong> Scallop Compiler</a></li><li class="chapter-item expanded affix "><li class="part-title">For Developers</li><li class="chapter-item expanded "><a href="../developer/index.html"><strong aria-hidden="true">10.</strong> For Developers</a></li><li class="chapter-item expanded "><a href="../developer/language_construct.html"><strong aria-hidden="true">11.</strong> New Language Construct</a></li><li class="chapter-item expanded "><a href="../developer/binding.html"><strong aria-hidden="true">12.</strong> New Binding</a></li><li class="chapter-item expanded affix "><li class="part-title">Resources</li><li class="chapter-item expanded "><a href="../grammar.html"><strong aria-hidden="true">13.</strong> Full Scallop Grammar</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><a href="../misc/contributors.html">Contributors</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Scallop Book</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="relations-and-facts"><a class="header" href="#relations-and-facts">Relations and Facts</a></h1>
<p>Scallop is a relational and logical programming language.
As described in the <a href="https://en.wikipedia.org/wiki/Logic_programming">Wikipedia</a>:</p>
<blockquote>
<p>Logic programming is a programming paradigm which is largely based on formal logic.
Any program written in a logic programming language is a set of sentences in logical form,
expressing facts and rules about some problem domain.</p>
</blockquote>
<p>In Scallop, relations are the most fundamental building blocks of program.
In the following example, we have declared the type of a relation called <code>edge</code>, using the <code>type</code> keyword:</p>
<pre><code class="language-scl">type edge(a: i32, b: i32)
</code></pre>
<p>We say that the name <code>edge</code> is a <em>predicate</em> or a <em>relation</em>.
Inside of the parenthesis, we have two <code>arguments</code>, <code>a: i32</code> and <code>b: i32</code>.
Therefore, we have <code>edge</code> being an <em>arity-2</em> relation, due to it having 2 arguments.
For the argument <code>a: i32</code>, we give a name of the field (<code>a</code>) and a type of that argument <code>i32</code>.
Here, both of the arguments are of the <code>i32</code> type, which means signed-<em>i</em>nteger, <em>32</em>-bit.
For more information on value types, refer to <a href="#value-types">the Value Types section</a>.</p>
<p>The above line only declares the type of the relation but not the <em>content</em> of the relation.
The actual information stored in the relations are called <em>facts</em>.
Here we define a single fact under the relation <code>edge</code>:</p>
<pre><code class="language-scl">rel edge(0, 1)
</code></pre>
<p>Assuming <code>0</code> and <code>1</code> each denote an ID of a node, this fact declares that there is an edge going from node <code>0</code> to node <code>1</code>.
There are two arguments in this fact, matching the arity of this relation.
Regardless of the predicate <code>edge</code>, one also simply consider the <code>(0, 1)</code> as a <em>tuple</em>, more specifically, a <em>2-tuple</em>.</p>
<p>To declare multiple facts, one can simply write multiple single fact declaration using the <code>rel</code> keyword, like</p>
<pre><code class="language-scl">rel edge(0, 1)
rel edge(1, 2)
</code></pre>
<p>One can also use the <em>set</em> syntax to declare multiple facts of a relation.
The following line reads: &quot;the relation <code>edge</code> contains a set of tuples, including <code>(0, 1)</code> and <code>(1, 2)</code>&quot;:</p>
<pre><code class="language-scl">rel edge = {(0, 1), (1, 2)}
</code></pre>
<p>Note that it is possible to declare multiple fact sets for the same relation.</p>
<pre><code class="language-scl">rel edge = {(0, 1), (1, 2)}
rel edge = {(2, 3)}
</code></pre>
<p>With the above two lines the edge relation now contains 3 facts, <code>(0, 1)</code>, <code>(1, 2)</code>, and <code>(2, 3)</code>.</p>
<h2 id="examples-of-relations"><a class="header" href="#examples-of-relations">Examples of Relations</a></h2>
<h3 id="boolean-and-0-arity-relation"><a class="header" href="#boolean-and-0-arity-relation">Boolean and 0-arity Relation</a></h3>
<p>Many things can be represented as relations.
We start with the most basic programming construct, boolean.
While Scallop allows value to have the boolean type, relations themselves can encode boolean values.
The following example contains an <em>arity-0</em> relation named <code>is_target</code>:</p>
<pre><code class="language-scl">type is_target()
</code></pre>
<p>There is only one possible tuple that could form a fact in this relation, that is the <em>empty tuple</em> <code>()</code>.
Assuming that we are treating the relation <code>is_target</code> as a set, then if the set contains no element (i.e., empty), then it encodes boolean &quot;false&quot;.
Otherwise, if the set contains exactly one (note: it can contain at most one) tuple, then it encodes boolean &quot;true&quot;.
Declaring only the type of <code>is_target</code> as above, would assume that the relation is empty.
To declare the fact, we can do:</p>
<pre><code class="language-scl">rel is_target()
// or
rel is_target = {()}
</code></pre>
<h3 id="unary-relations"><a class="header" href="#unary-relations">Unary Relations</a></h3>
<p>Unary relations are relations of arity 1.
We can define unary relations for &quot;variables&quot; as we see in other programming languages.
The following example declares a relation named <code>greeting</code> containing one single string of <code>&quot;hello world!&quot;</code>.</p>
<pre><code class="language-scl">rel greeting(&quot;hello world!&quot;)
// or
rel greeting = {(&quot;hello world!&quot;,)}
</code></pre>
<p>Note that for the second way of expressing the fact, we may omit the parenthesis and make it cleaner:</p>
<pre><code class="language-scl">rel greeting = {&quot;hello world!&quot;}
</code></pre>
<p>In light of this, we may write the following rule:</p>
<pre><code class="language-scl">rel possible_digit = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9}
</code></pre>
<h3 id="integer-arithmetics-as-relations"><a class="header" href="#integer-arithmetics-as-relations">Integer Arithmetics as Relations</a></h3>
<p>Integer arithmetics can be represented as relations as well.
Consider a simple summation in algebra, <code>a + b = c</code> encodes the sum relationship among two operands (<code>a</code> and <code>b</code>) and their summation (<code>c</code>).
Encoded in Scallop, they form arity-3 relations:</p>
<pre><code class="language-scl">type add(op1: i32, op2: i32, result: i32)
</code></pre>
<p>Note that, in Scallop, relations are <em>not</em> polymorphic.
That is, every relation, no matter declared or inferred, only has one type annotation.</p>
<blockquote>
<p>We are working on an update in the future to relax this restriction.</p>
</blockquote>
<p>To declare facts of this <code>add</code> relation, such as <code>3 + 4 = 7</code>, we write</p>
<pre><code class="language-scl">rel add(3, 4, 7) // 3 + 4 = 7
</code></pre>
<p>However, you might notice that the <code>add</code> relation is theoretically <em>infinite</em>.
That is, there are infinite amount of facts that can satisfy the <code>add</code> relation.
There is no way that we can possibly enumerate or declare all the facts.
In such case, we resort to declaring rules using foreign functions or predicates, which we will discuss later.
For now, let's use <code>add</code> as an example relation that encodes integer arithmetics.</p>
<h3 id="terminologies"><a class="header" href="#terminologies">Terminologies</a></h3>
<p>We have the following terminologies for describing relations.</p>
<ul>
<li>Boolean Relation: arity-0 relation</li>
<li>Unary Relation: arity-1 relation</li>
<li>Binary Relation: arity-2 relation</li>
<li>Ternary Relation: arity-3 relation</li>
</ul>
<h2 id="type-inference"><a class="header" href="#type-inference">Type Inference</a></h2>
<p>Scallop supports <em>Type Inference</em>.
One does not need to fully annotate every relation on their types.
Types are inferred during the compilation process.</p>
<p>For example, given the following code,</p>
<pre><code class="language-scl">rel edge = {(0, 1), (1, 2)}
</code></pre>
<p>we can infer that the relation <code>edge</code> is a binary-relation where both arguments are integers.
Note that when integers are specified, they are set default to the type of <code>i32</code>.</p>
<p>Type inference will fail if conflicts are detected.
In the following snippet, we have the second argument being <code>1</code> as integer and also <code>&quot;1&quot;</code> as string.</p>
<pre><code class="language-scl">rel edge = {(0, 1), (0, &quot;1&quot;)}
</code></pre>
<p>Having this code will raise the following compile error, suggesting that the types cannot be unified.
Note that the following response is generated in <code>sclrepl</code> command line interface.</p>
<pre><code>[Error] cannot unify types `numeric` and `string`, where the first is declared here
  REPL:0 | rel edge = {(0, 1), (0, &quot;1&quot;)}
         |                 ^
and the second is declared here
  REPL:0 | rel edge = {(0, 1), (0, &quot;1&quot;)}
         |                         ^^^
</code></pre>
<p>For more information on values and types, please refer to the <a href="value_type.html">next section</a></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../language/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../language/rules.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../language/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../language/rules.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../js/hljs_scallop.js"></script>


    </div>
    </body>
</html>
